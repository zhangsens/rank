!function(t){function e(i){if(s[i])return s[i].exports;var a=s[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var s={};e.m=t,e.c=s,e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,s){"use strict";var i=s(1),a=s(2),r=function(t){return t&&t.__esModule?t:{default:t}}(a),h=document.createElement("canvas");document.querySelector("#app").appendChild(h),h.width=1400,h.height=2e3,h.style.cssTest="position:relative",h.innerText="您的浏览器暂不支持哦๑乛◡乛๑";var c=h.getContext("2d");(0,i.data)().then(function(t){new r.default(c,t)},function(t){console.log(t)})},function(t,e,s){"use strict";function i(){return new Promise(function(t,e){var s=new XMLHttpRequest;s.open("POST","/data",!1),s.send(null),s.responseText?t(JSON.parse(s.responseText)):e(0)})}Object.defineProperty(e,"__esModule",{value:!0}),e.data=i},function(t,e,s){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=s(3),h=i(r),c=s(4),n=i(c),o=s(5),l=i(o),d=function(t,e){this.data=e.result,this.data.sort(this.descending("ballot_sum")),this.ctx=t,this.width=this.ctx.canvas.width-200,this.height=this.ctx.canvas.width,this.personalDetail=new n.default,this.characters=[],console.log(this.data);for(var s=0;s<this.data.length;s++){var i=s*(this.width-200)/30+100,a=0==s?100:(this.data[0].ballot_ratio-this.data[s-1].ballot_ratio)/2+100,r="hsla("+360*s/this.data.length+",80%,50%,1)",c=new l.default(this.data[s],i,a,1,r);c.nX=this.width,c.nY=20*(s+1)+100,c.radioX=this.width+200+200*s,this.characters.push(c)}this.draw(),new h.default(this.characters,this.ctx).test(),this.ctx.canvas.onmousemove=this.mousemove.bind(this)};d.prototype={ascending:function(t){return function(e,s){return e[t]-s[t]}},descending:function(t){return function(e,s){return s[t]-e[t]}},chart:function(){this.ctx.strokeStyle="hsla(200,80%,60%,1)",this.ctx.moveTo(100,50),this.ctx.lineTo(100,700),this.ctx.lineTo(this.width-50,700),this.ctx.stroke(),this.ctx.strokeStyle="hsla(0,0%,0%,0.5)";for(var t=0;t<6;t++)this.ctx.beginPath(),this.ctx.lineTo(100,100*(t+1)),this.ctx.lineTo(this.width-100,100*(t+1)),this.ctx.stroke();for(var e=0;e<10;e++)this.ctx.save(),this.ctx.beginPath(),this.ctx.lineTo(100+(e+1)*(this.width-200)/10,100),this.ctx.lineTo(100+(e+1)*(this.width-200)/10,700),this.ctx.stroke(),this.ctx.fillStyle=this.characters[e].color,this.ctx.translate(90+20*(e+1),720),this.ctx.rotate(4*Math.PI/9),this.ctx.restore()},rang:function(t,e){for(var s=(e-t)/6,i=0;i<7;i++)this.ctx.fillText(e-i*s,0,100*(i+1))},list:function(){for(var t=0;t<this.characters.length;t++)this.ctx.font=this.characters[t].fontSize+"px Arial",this.ctx.fillStyle=this.characters[t].color,this.ctx.fillText(this.characters[t].data.chn_name,this.characters[t].nX,this.characters[t].nY)},radio:function(){this.ctx.clearRect(0,1e3,this.width+200,200);for(var t=0;t<this.characters.length;t++)this.ctx.fillStyle="hsla(0,100%,0%,1)",this.ctx.fillText(this.characters[t].data.chn_name+":"+this.characters[t].data.ballot_sum+"票",this.characters[t].radioX,1100),this.ctx.fillText("有"+this.characters[t].data.real_love_num+"人和你抢老婆",this.characters[t].radioX,1120),--this.characters[t].radioX<0&&(this.characters[t].radioX=200*this.data.length)},draw:function(){for(var t=0,e=0,s=0,i=0,a=0;i<1;s++)a=this.characters[0].data.ballot_sum/Math.pow(10,s),a>10?(t=Math.floor(a)*Math.pow(10,s),i=0,e=s):i=1;t=Math.ceil(t/(6*Math.pow(10,e)))*(6*Math.pow(10,e)),this.ctx.clearRect(0,0,this.width+200,900),this.chart(),this.rang(0,t),this.list(),new h.default(this.characters,this.ctx).rectangle("ballot_sum",t),requestAnimationFrame(this.draw.bind(this))},mousemove:function(t){for(var e=this,s=t.offsetX,i=t.offsetY,r=!0,h=this.personalDetail.personal,c=new Object,n=0;n<this.characters.length;n++){var o;!function(n){s>e.characters[n].nX&&s<e.characters[n].nX+200&&i>e.characters[n].nY-10&&i<e.characters[n].nY?(r=!1,e.characters[n].fontSize=15,e.personalDetail.show(t),c.character_id=""+e.characters[n].data.character_id,c.cover=""+e.characters[n].data.cover,h.dataset.id!=c.character_id&&(h.dataset.id=c.character_id,o=new XMLHttpRequest,o.open("POST","/imgdata64",!0),o.send(JSON.stringify(c)),o.onreadystatechange=function(){if(200==o.status&&o.responseText){console.log(a(o.responseText));var t=JSON.parse(o.responseText);console.log(void 0===t?"undefined":a(t)),h.querySelector("img").src="data:image/gif;base64,"+t.cover,h.querySelector("div").innerHTML="\n                                名字:"+this.characters[n].data.chn_name+",</br>\n                                得票总数:"+this.characters[n].data.ballot_sum+",</br>\n                                比率:"+this.characters[n].data.ballot_ratio+",</br>\n                                性别:"+(1==this.characters[n].data.sex?"女":"男")+"</br>\n                                "}}.bind(e))):e.characters[n].fontSize=10}(n)}r&&this.personalDetail.hide()},click:function(){}},e.default=d},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){this.characters=t,this.ctx=e,this.width=this.ctx.canvas.width-200,this.height=this.ctx.canvas.width};i.prototype={line:function(t,e){for(var s=0;s<this.characters.length;s++)0==s?(this.ctx.beginPath(),this.ctx.moveTo(this.characters[s].x,this.characters[s].y)):(this.ctx.beginPath(),this.ctx.moveTo(this.characters[s-1].x,this.characters[s-1].y),this.ctx.lineTo(this.characters[s].x,this.characters[s].y)),this.ctx.arc(this.characters[s].x,this.characters[s].y,this.characters[s].r,0,2*Math.PI),this.ctx.strokeStyle=this.characters[s].color,this.ctx.stroke()},rectangle:function(t,e){for(var s=0;s<this.characters.length;s++){this.ctx.fillStyle=this.characters[s].color;var i=this.characters[s].data[t]/e,a=10==this.characters[s].fontSize?0:1;this.ctx.save(),this.ctx.font=this.characters[s].fontSize+"px Arial",this.ctx.fillRect(this.characters[s].x-5*a,600*(1-i)+100-10*a,20+10*a,600*i+10*a),this.ctx.translate(this.characters[s].x,720),this.ctx.rotate(4*Math.PI/9),this.ctx.fillText(this.characters[s].data.chn_name,0,0),this.ctx.restore(),this.ctx.font="10px Arial",this.ctx.fillStyle="hsla(0,0%,0%,1)",this.ctx.fillText(this.characters[s].data[t],this.characters[s].x-10,600*(1-i)+100)}},timg:function(t,e){},test:function(){for(var t=0;t<this.characters.length;t++)this.ctx.fillStyle="hsla("+360*t/this.characters.length+",80%,50%,1)",this.ctx.fillText(this.characters[t].data.chn_name+":"+this.characters[t].data.ballot_sum+"票",0,40*(t+.25)+800),this.ctx.fillText("有"+this.characters[t].data.real_love_num+"人和你抢老婆",0,40*(t+.75)+800)}},e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){this.personal=document.createElement("div"),document.body.appendChild(this.personal),this.personal.appendChild(new Image),this.personal.appendChild(document.createElement("div")),this.style=["none","absolute",250,400,0,0],this.personal.style="\n    display:"+this.style[0]+";\n    position:"+this.style[1]+";\n    width:"+this.style[2]+"px;\n    height:"+this.style[3]+"px;\n    top:"+this.style[4]+";\n    background-color:hsla(1,100%,100%,1);\n    left:"+this.style[5]+";"};i.prototype={show:function(t){this.style[0]="block",this.style[4]=t.offsetY+70>document.body.scrollTop?t.offsetY+70:document.body.scrollTop,this.style[5]=t.offsetX+this.style[2]+50>window.innerWidth?window.innerWidth-this.style[2]+15:t.clientX+15,this.personal.style="\n        display:"+this.style[0]+";\n        position:"+this.style[1]+";\n        width:"+this.style[2]+"px;\n        height:"+this.style[3]+"px;\n        top:"+this.style[4]+";\n        background-color:hsla(1,100%,100%,1);\n        left:"+this.style[5]+";"},hide:function(){this.style[0]="none",this.personal.style="\n        display:"+this.style[0]+";\n        position:"+this.style[1]+";\n        width:"+this.style[2]+"px;\n        height:"+this.style[3]+"px;\n        top:"+this.style[4]+";\n        background-color:hsla(1,100%,100%,1);\n        left:"+this.style[5]+";"}},e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e,s,i,a){this.data=t,this.x=e,this.y=s,this.r=i,this.fontSize=10,this.color=a};e.default=i}]);